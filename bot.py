import os
import time
import random
import io
import csv
from dataclasses import dataclass
from typing import List, Optional, Tuple

import psycopg
from psycopg.rows import dict_row

from telegram import Update, InlineKeyboardMarkup, InlineKeyboardButton, InputFile
from telegram.ext import (
    Application,
    CommandHandler,
    CallbackQueryHandler,
    ContextTypes,
    MessageHandler,
    filters,
)

# ==========================================================
# ====================== –ù–ê–°–¢–†–û–ô–ö–ò (ENV) ===================
# ==========================================================
BOT_TOKEN = os.environ.get("BOT_TOKEN")
DATABASE_URL = os.environ.get("DATABASE_URL")
ADMIN_IDS_RAW = os.environ.get("ADMIN_IDS", "")          # "123" –∏–ª–∏ "1,2,3"
ADMIN_IDS = {int(x.strip()) for x in ADMIN_IDS_RAW.split(",") if x.strip().isdigit()}

# —Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –±—Ä–∞—Ç—å –∑–∞ –æ–¥–Ω–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)
QUESTIONS_PER_RUN = int(os.environ.get("QUESTIONS_PER_RUN", "10"))

# —à—Ç—Ä–∞—Ñ –∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é +5 —Å–µ–∫)
WRONG_PENALTY_MS = int(os.environ.get("WRONG_PENALTY_MS", "5000"))

# ==========================================================
# ========================= –¢–ï–û–†–ò–Ø =========================
# –í—Å—Ç–∞–≤–ª—è–π –æ–¥–Ω–∏–º –±–æ–ª—å—à–∏–º —Ç–µ–∫—Å—Ç–æ–º (–º–æ–∂–Ω–æ –≤ ENV, –Ω–æ –ø—Ä–æ—â–µ –∑–¥–µ—Å—å)
# ==========================================================
THEORY_TEXT = os.environ.get("THEORY_TEXT", """
1. –ò–Ω–∂–µ–Ω–µ—Ä-–¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –≤—ã—è–≤–ª–µ–Ω–∏–µ–º –¥–µ—Ñ–µ–∫—Ç–æ–≤, –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∏ –±—Ä–∞–∫–∞ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–≤ –∏ –ø—Ä–∏–±–æ—Ä–æ–≤ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è. –¢–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–∞—é—Ç –æ–±—ä–µ–∫—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.

2. –ò–Ω–∂–µ–Ω–µ—Ä—ã-–¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç—ã –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –æ—Ç—Ä–∞—Å–ª—è—Ö –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –∏–ª–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –ù–∞–ø—Ä–∏–º–µ—Ä: 
–ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–æ–≤, –±—É—Ä–æ–≤—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫, –Ω–µ—Ñ—Ç—è–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º.
–ú–∞—à–∏–Ω–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ—Ç–∞–ª–µ–π –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π, —Ç—É—Ä–±–∏–Ω, –Ω–∞—Å–æ—Å–æ–≤, —Ä–µ–¥—É–∫—Ç–æ—Ä–æ–≤.
–í–∞–≥–æ–Ω–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª—ë—Å–Ω—ã—Ö –ø–∞—Ä, —Ä–∞–º, –±–æ–∫—Å–æ–≤ –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã—Ö –≤–∞–≥–æ–Ω–æ–≤.
–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–∞—Ä–Ω—ã—Ö —à–≤–æ–≤, –∞—Ä–º–∞—Ç—É—Ä—ã, —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–≤ –∑–¥–∞–Ω–∏–π –∏ —Å–æ–æ—Ä—É–∂–µ–Ω–∏–π.

3. –ù–µ—Ä–∞–∑—Ä—É—à–∞—é—â–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–ù–ö) ‚Äî —ç—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å–≤–æ–π—Å—Ç–≤ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–∞ –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–µ —Ç—Ä–µ–±—É—é—â–∏–π –≤—ã–≤–µ–¥–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏–∑ —Ä–∞–±–æ—Ç—ã –ª–∏–±–æ –µ–≥–æ –¥–µ–º–æ–Ω—Ç–∞–∂–∞.

4. –í–∏–∑—É–∞–ª—å–Ω–æ-–∏–∑–º–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–í–ò–ö) ‚Äî –º–µ—Ç–æ–¥, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ–º –æ—Å–º–æ—Ç—Ä–µ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –æ–±—ä–µ–∫—Ç–æ–≤. –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è, –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–µ—Ä–æ–≤–Ω–æ—Å—Ç–∏ —Å–≤–∞—Ä–Ω—ã—Ö —à–≤–æ–≤.

5. –£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–£–ó–ö) ‚Äî –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤—ã–µ –≤–æ–ª–Ω—ã —á–∞—Å—Ç–æ—Ç–æ–π –æ—Ç 0,5 –¥–æ 25 –ú–ì—Ü –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤.
–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã: –≤ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –æ–±—ä–µ–∫—Ç –≤–≤–æ–¥–∏—Ç—Å—è —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –∏–º–ø—É–ª—å—Å —á–µ—Ä–µ–∑ –ø—å–µ–∑–æ—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å. –ó–≤—É–∫–æ–≤—ã–µ –≤–æ–ª–Ω—ã —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ–º –º–∞—Ç–µ—Ä–∏–∞–ª–µ –ø–æ –ø—Ä—è–º–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏, –Ω–æ –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –æ—Ç –≥—Ä–∞–Ω–∏—Ü —Ä–∞–∑–¥–µ–ª–∞ —Å—Ä–µ–¥ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è–º–∏. –ü—Ä–∏ –≤—Å—Ç—Ä–µ—á–µ —Å –¥–µ—Ñ–µ–∫—Ç–∞–º–∏ –≤–æ–ª–Ω—ã –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –∫ –ø—Ä–∏—ë–º–Ω–∏–∫—É. –ü–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –ø—Ä–∏–Ω—è—Ç–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –Ω–∞–ª–∏—á–∏–µ, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ —Ä–∞–∑–º–µ—Ä –¥–µ—Ñ–µ–∫—Ç–æ–≤.

6. –†–∞–¥–∏–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–†–ù–ö) ‚Äî –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–æ–Ω–∏–∑–∏—Ä—É—é—â–µ–µ –∏–∑–ª—É—á–µ–Ω–∏–µ (—Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏–µ –∏–ª–∏ –≥–∞–º–º–∞-–ª—É—á–∏) –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤ –≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∞—Ö –∏ —Å–≤–∞—Ä–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è—Ö.
–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã: –ø–æ—Ç–æ–∫ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏—Ö –∏–ª–∏ –≥–∞–º–º–∞-–ª—É—á–µ–π –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –æ–±—ä–µ–∫—Ç –∏ –æ—Å–ª–∞–±–ª—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞. –ò—Ç–æ–≥ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø–ª—ë–Ω–∫–µ –∏–ª–∏ —Ü–∏—Ñ—Ä–æ–≤–æ–º –¥–µ—Ç–µ–∫—Ç–æ—Ä–µ, –æ–±—Ä–∞–∑—É—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

7. –¢–µ–ø–ª–æ–≤–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–¢–ö) ‚Äî –º–µ—Ç–æ–¥, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –∏–Ω—Ñ—Ä–∞–∫—Ä–∞—Å–Ω–æ–≥–æ –∏–∑–ª—É—á–µ–Ω–∏—è –≤ –≤–∏–¥–∏–º—ã–π —Å–ø–µ–∫—Ç—Ä.
–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã: –ª—é–±—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã –∏–∑–º–µ–Ω—è—é—Ç —Ç–µ–ø–ª–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –∏ —Å–æ–∑–¥–∞—é—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏.

8. –ü—Ä–∏–º–µ—Ä—ã –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏–∑ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏:
‚Ä¢  –í—ã–±–æ—Ä —Å–ø–µ–ª–æ–≥–æ –∞—Ä–±—É–∑–∞
–°–ª—É—à–∞–µ—à—å –∑–≤—É–∫: –≥–ª—É—Ö–æ–π ‚Äî –ø–µ—Ä–µ–∑—Ä–µ–ª—ã–π, –∑–≤–æ–Ω–∫–∏–π ‚Äî —Å–ø–µ–ª—ã–π. –≠—Ç–æ –∫–∞–∫ —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å ‚Äî —ç—Ö–æ ¬´—Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç¬ª –ø—Ä–æ ¬´–≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–∏¬ª.
‚Ä¢  –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ –ª–±—É
–ü—Ä–∏–ª–æ–∂–∏–ª ‚Äî —É–∑–Ω–∞–ª —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É. –ù–µ –ø—Ä–æ–∫–∞–ª—ã–≤–∞–µ—à—å –∫–æ–∂—É, –Ω–æ –≤–∏–¥–∏—à—å, —á—Ç–æ –≤–Ω—É—Ç—Ä–∏. –ß–∏—Å—Ç—ã–π –ù–ö.
1.  –£–ó–ò —É –≤—Ä–∞—á–∞
–°–º–æ—Ç—Ä—è—Ç –Ω–∞ –º–∞–ª—ã—à–∞ –≤ –∂–∏–≤–æ—Ç–µ ‚Äî –±–µ–∑ —Ä–∞–∑—Ä–µ–∑–æ–≤, —Ç–æ–ª—å–∫–æ –≥–µ–ª—å –∏ –¥–∞—Ç—á–∏–∫. –¢–æ—Ç –∂–µ –ø—Ä–∏–Ω—Ü–∏–ø, —á—Ç–æ —É –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç–∞ —Å –º–µ—Ç–∞–ª–ª–æ–º.
‚Ä¢  –†–µ–Ω—Ç–≥–µ–Ω –∑—É–±–∞ ü¶∑
–î–µ–ª–∞—é—Ç —Å–Ω–∏–º–æ–∫ ‚Äî –≤–∏–¥—è—Ç –∫–∞—Ä–∏–µ—Å –ø–æ–¥ —ç–º–∞–ª—å—é. –ù–µ —Å–≤–µ—Ä–ª—è—Ç –Ω–∞—É–≥–∞–¥, –∞ —Å–Ω–∞—á–∞–ª–∞ ¬´–ø—Ä–æ—Å–≤–µ—á–∏–≤–∞—é—Ç¬ª.
‚Ä¢  –ú–µ—Ç–∞–ª–ª–æ–¥–µ—Ç–µ–∫—Ç–æ—Ä –Ω–∞ –ø–ª—è–∂–µ
–í–µ–¥–µ—à—å –ø—Ä–∏–±–æ—Ä–æ–º –ø–æ –ø–µ—Å–∫—É ‚Äî –ø–∏—â–∏—Ç –Ω–∞ –º–æ–Ω–µ—Ç—É –ø–æ–¥ –∑–µ–º–ª–µ–π. –ù–µ –∫–æ–ø–∞–µ—à—å –≤—Å—é –ø–ª–æ—â–∞–¥–∫—É, –∞ –Ω–∞—Ö–æ–¥–∏—à—å —Ü–µ–ª—å —Ç–æ—á–Ω–æ.
‚Ä¢  –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ–ª–æ—Å—Ç–∏ –∞–≤–æ–∫–∞–¥–æ
–°–ª–µ–≥–∫–∞ —Å–∂–∏–º–∞–µ—à—å –≤ —Ä—É–∫–µ ‚Äî –º—è–≥–∫–∏–π = –≥–æ—Ç–æ–≤ –∫ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—é. –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –ù–ö –±–µ–∑ —Ä–∞–∑—Ä–µ–∑–∞–Ω–∏—è.
‚Ä¢  –û–±–Ω–∞—Ä—É–∂–∏—Ç–µ–ª—å –ø—Ä–æ–≤–æ–¥–∫–∏ –≤ —Å—Ç–µ–Ω–µ
–ü—Ä–æ–≤–µ–ª –ø—Ä–∏–±–æ—Ä–æ–º ‚Äî –∑–∞–º–∏–≥–∞–ª: ¬´—Ç—É—Ç –ø—Ä–æ–≤–æ–¥¬ª. –ù–µ –¥–æ–ª–±–∏—à—å –Ω–∞—É–≥–∞–¥, –∞ —Å–Ω–∞—á–∞–ª–∞ —Å–∫–∞–Ω–∏—Ä—É–µ—à—å.
‚Ä¢  –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–Ω–µ—Ç—ã –Ω–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å
–ü–æ–¥–Ω–æ—Å–∏—à—å –∫ –º–∞–≥–Ω–∏—Ç—É ‚Äî –Ω–∞—Å—Ç–æ—è—â–∞—è –Ω–µ –ø—Ä–∏—Ç—è–Ω–µ—Ç—Å—è (–º–µ–¥—å/–Ω–∏–∫–µ–ª—å), —Ñ–∞–ª—å—à–∏–≤–∫–∞ ‚Äî –ø—Ä–∏–ª–∏–ø–Ω–µ—Ç (–∂–µ–ª–µ–∑–æ). –ú–∞–≥–Ω–∏—Ç–Ω—ã–π –º–µ—Ç–æ–¥ –ù–ö.
‚Ä¢  –ü—Ä–æ—Å–≤–µ—Ç–∏—Ç—å —è–π—Ü–æ –æ–≤–æ—Å–∫–æ–ø–æ–º
–ü–æ–¥–Ω–µ—Å—è –∫ –ª–∞–º–ø–µ, –≤–∏–¥–∏—à—å, —Å–≤–µ–∂–µ–µ –∏–ª–∏ —Å –∏—Å–ø–æ—Ä—á–µ–Ω–Ω—ã–º –∂–µ–ª—Ç–∫–æ–º ‚Äî –±–µ–∑ —Ä–∞–∑–±–∏–≤–∞–Ω–∏—è.
‚Ä¢  –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–µ–¥–∏ –Ω–∞ –¥–æ—Ä–æ–≥–µ
–í–æ–¥–∏—Ç–µ–ª—å –ø—Ä–∏—Ç–æ—Ä–º–∞–∂–∏–≤–∞–µ—Ç –∏ ¬´–ø—Ä–∏—Å–ª—É—à–∏–≤–∞–µ—Ç—Å—è¬ª –∫ —à–∏–Ω–∞–º: —Å–∫—Ä–∏–ø = –≥–æ–ª–æ–ª—ë–¥. –ê–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–π –ù–ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
""").strip()

# ==========================================================
# ========================= –í–û–ü–†–û–°–´ =========================
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—à—å –¢–û–õ–¨–ö–û –≠–¢–û–¢ –ë–õ–û–ö
# ==========================================================
@dataclass
class Question:
    text: str
    options: List[str]         # –≤–∞—Ä–∏–∞–Ω—Ç—ã
    correct: int               # –∏–Ω–¥–µ–∫—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
    hint_wrong: str            # –ø–æ–¥—Å–∫–∞–∑–∫–∞ –µ—Å–ª–∏ –Ω–µ–≤–µ—Ä–Ω–æ
    explain_right: str         # –ø–æ—è—Å–Ω–µ–Ω–∏–µ –µ—Å–ª–∏ –≤–µ—Ä–Ω–æ
    photo_path: Optional[str] = None  # "assets/q1.png" (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

# ---- –¢–í–û–ò –í–û–ü–†–û–°–´ (–≤—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –µ—Å—Ç—å) ----
QUESTIONS: List[Question] = [
    Question(
        text="–ò–Ω–∂–µ–Ω–µ—Ä–æ–≤ –ø–æ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—é —á–∞—Å—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç —Å –≤—Ä–∞—á–∞–º–∏ - –¥–∏–∞–≥–Ω–æ—Å—Ç–∞–º–∏. –ú–µ–¥–∏–∫–∏ –ø—Ä–æ–≤–æ–¥—è—Ç –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –≤—ã—è–≤–∏—Ç—å –∏ –∏—Å–∫–ª—é—á–∏—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –æ—Ä–≥–∞–Ω–æ–≤ –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤. –î–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç ¬´–∑–¥–æ—Ä–æ–≤—å–µ¬ª –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. –ò —Ç–µ –∏ –¥—Ä—É–≥–∏–µ –¥–æ–ª–∂–Ω—ã —É–º–µ—Ç—å –≤—ã—è–≤–∏—Ç—å ¬´–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ¬ª –Ω–∞ –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–∞–Ω–Ω–µ–π —Å—Ç–∞–¥–∏–∏, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –¥–∏–∞–≥–Ω–æ–∑ –∏ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –ª–µ—á–µ–Ω–∏–µ, –∞ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö –≤—ã–ø–∏—Å–∞—Ç—å –ª–∏—Å—Ç–æ–∫ –Ω–µ—Ç—Ä—É–¥–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏. –ï—Å–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ –∏ –º–µ–¥–∏–∫–æ–≤, —Ç–æ –∫–∞–∫–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ –≤—Ä–∞—á—É-—Ö–∏—Ä—É—Ä–≥—É?",
        options=["–ò–Ω–∂–µ–Ω–µ—Ä-—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫", "–ò–Ω–∂–µ–Ω–µ—Ä -—Å—Ö–µ–º–æ—Ç–µ—Ö–Ω–∏–∫", "–ò–Ω–∂–µ–Ω–µ—Ä –ø–æ —Ä–∞–∑—Ä—É—à–∞—é—â–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—é", "–ò–Ω–∂–µ–Ω–µ—Ä-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç"],
        correct=2,
        hint_wrong="–ù–µ–º–Ω–æ–≥–æ –Ω–µ —Ç–∞–∫ –¥—É–º–∞–µ—à—å –ø–æ–¥—É–º–∞–π –µ—â–µ",
        explain_right="–ò–Ω–∂–µ–Ω–µ—Ä —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö —ç–Ω–µ—Ä–≥–æ—Å–Ω–∞–±–∂–µ–Ω–∏—è, –¥–ª—è —á–µ–ª–æ–≤–µ–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —ç–Ω–µ—Ä–≥–∏–∏ —è–≤–ª—è–µ—Ç—Å—è —Å–∫–æ—Ä–µ–µ –ø–∏—â–µ–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ –Ω–∞–≤–µ—Ä–Ω–æ –≥–∞—Å—Ç—Ä–æ—ç–Ω—Ç–µ—Ä–æ–ª–æ–≥. –ò–Ω–∂–µ–Ω–µ—Ä-—Å—Ö–µ–º–æ—Ç–µ—Ö–Ω–∏–∫ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ø–µ–π –∏ —ç—Ç–æ –Ω–∞–≤–µ—Ä–Ω–æ –±–ª–∏–∂–µ –∫ –Ω–µ–≤—Ä–æ–ª–æ–≥—É. –ò–Ω–∂–µ–Ω–µ—Ä-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∏ —ç—Ç–æ –±–ª–∏–∂–µ –∫ –≤—ã—Å—à–µ–π –Ω–µ—Ä–≤–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–≤–µ—Ä–Ω–æ –≤—Ä–∞—á—É –ø—Å–∏—Ö–∏–∞—Ç—Ä—É. –ê –≤–æ—Ç —Ö–∏—Ä—É—Ä–≥, –∫–æ—Ç–æ—Ä–æ–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –æ—Ä–≥–∞–Ω–∞–º –±–ª–∏–∂–µ –∫ –∏–Ω–∂–µ–Ω–µ—Ä—É –ø–æ —Ä–∞–∑—Ä—É—à–∞—é—â–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—é.",
    ),
    Question(
        text="–ó–∞–¥–æ–ª–≥–æ –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ—è–≤–∏–ª—Å—è —Ç–µ—Ä–º–∏–Ω ¬´–Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å¬ª, –ª—é–¥–∏ –æ—Å–º–∞—Ç—Ä–∏–≤–∞–ª–∏ –æ–±—ä–µ–∫—Ç—ã, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–∑–º–µ—Ä, —Ñ–æ—Ä–º—É –∏ –Ω–∞–ª–∏—á–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏. –í –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å —Ç–∞–∫–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å –±—ã–ª —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω –Ω–∞ —è—Ä–º–∞—Ä–∫–∞—Ö, —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞. –û—Å–æ–±—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–ª–∏ –∏–∑–¥–µ–ª–∏—è –∫—É–∑–Ω–µ—á–Ω–æ–≥–æ –¥–µ–ª–∞ ‚Äì –º–µ—á–∏, —Å–∞–±–ª–∏, —Ç–æ–ø–æ—Ä—ã, –∫–∏–Ω–∂–∞–ª—ã. –ö–∞—á–µ—Å—Ç–≤–æ —Å—Ç–∞–ª–∏ –ø—Ä–æ–≤–µ—Ä—è–ª–∏ —É–¥–∞—Ä–∞–º–∏ –ø–æ –ø–æ–ª–æ—Å–µ –∂–µ–ª–µ–∑–∞. –ö–∞–∫–æ–π –≤–∏–¥ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∫—É–∑–Ω–µ—Ü—ã?",
        options=["–†–∞–∑—Ä—É—à–∞—é—â–∏–π", "–ê–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–π", "–í–∏–∑—É–∞–ª—å–Ω—ã–π", "–ú–∞–≥–Ω–∏—Ç–æ–ø–æ—Ä–æ—à–∫–æ–≤—ã–π"],
        correct=1,
        hint_wrong="–ê —Ç—ã –¥—É–º–∞–ª –≤—Å–µ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ –±—É–¥–µ—Ç ",
        explain_right="–∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–π, –∫—É–∑–Ω–µ—Ü—ã –ø—Ä–∏—Å–ª—É—à–∏–≤–∞–ª–∏—Å—å –∫ –º–µ—Ç–∞–ª–ª—É, —á—Ç–æ–±—ã –ø–æ –∑–≤—É–∫—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã. –≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–æ–±—Ä–∞–∑–æ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —ç—Ö–æ-–∏–º–ø—É–ª—å—Å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞, –∫–æ–≥–¥–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ—Å—ã–ª–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ –∏–º–ø—É–ª—å—Å—ã —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤—ã—Ö –∫–æ–ª–µ–±–∞–Ω–∏–π –≤ –º–∞—Ç–µ—Ä–∏–∞–ª, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –æ—Ç –¥–µ—Ñ–µ–∫—Ç–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ. –ü–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –¥–µ—Ñ–µ–∫—Ç–∞, –∞ –ø–æ –∞–º–ø–ª–∏—Ç—É–¥–µ –æ—Ç—Ä–∞–∂—ë–Ω–Ω–æ–≥–æ –∏–º–ø—É–ª—å—Å–∞ ‚Äî –µ–≥–æ —Ä–∞–∑–º–µ—Ä.",
    ),
    Question(
        text="–í–æ –≤—Ä–µ–º–µ–Ω–∞ –î—Ä–µ–≤–Ω–µ–≥–æ –†–∏–º–∞ –±–æ–ª—å—à–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª—è–ª–æ—Å—å –∫–∞—á–µ—Å—Ç–≤—É –º—Ä–∞–º–æ—Ä–∞, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –∏–∑–≥–æ—Ç–∞–≤–ª–∏–≤–∞–ª–∏—Å—å –Ω–µ —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É–∏, –Ω–æ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–¥–∞–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –≤—ã–¥–µ—Ä–∂–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏. –í–∞–∂–Ω–æ –±—ã–ª–æ –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –º–∞–ª–µ–π—à–∏–µ —Ç—Ä–µ—â–∏–Ω—ã. –î–ª—è –∏—Ö –≤—ã—è–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –º—É–∫—É –∏ –º–∞—Å–ª–æ. –î–µ—Ñ–µ–∫—Ç—ã –æ–ø—Ä–µ–¥–µ–ª—è–ª—Å—è –ø–æ —Ä—è–¥—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—É—á–∏–≤—à–µ–≥–æ—Å—è —Ä–∏—Å—É–Ω–∫–∞. –ú–∞—Å–ª–æ –∑–∞–ø–æ–ª–Ω—è–ª–æ –º–∞–ª–µ–π—à–∏–µ —Ç—Ä–µ—â–∏–Ω—ã, –º—É–∫–∞ –¥–µ–ª–∞–ª–æ —Ä–∏—Å—É–Ω–æ–∫ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–º. –ü—Ä–æ–æ–±—Ä–∞–∑–æ–º –∫–∞–∫–æ–≥–æ –≤–∏–¥–∞ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è —è–≤–ª—è–µ—Ç—Å—è –æ–ø–∏—Å–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –¥—Ä–µ–≤–Ω–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤?",
        options=["–ú–∞–≥–Ω–∏—Ç–æ–ø–æ—Ä–æ—à–∫–æ–≤—ã–π", "–í–∏–∑—É–∞–ª—å–Ω—ã–π", "–ö–∞–ø–∏–ª–ª—è—Ä–Ω—ã–π", "–£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π"],
        correct=2,
        hint_wrong="–°–ª–æ–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å –ø–æ–Ω–∏–º–∞—é —Ç–µ–±—è",
        explain_right="–∫–∞–ø–∏–ª–ª—è—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∏–ª–∏ —Ü–≤–µ—Ç–Ω–∞—è –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ–≤–µ—Ä—è–µ–º–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å —Å–º–∞—á–∏–≤–∞–µ—Ç—Å—è —Å–º–∞—á–∏–≤–∞–µ—Ç—Å—è –æ–∫—Ä–∞—à–µ–Ω–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç—å—é, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø–æ–ª–Ω—è–µ—Ç –¥–∞–∂–µ —Å–∞–º—ã–µ –º–µ–ª—å—á–∞–π—à–∏–µ –ø–æ—Ä—ã –∏ —Ç—Ä–µ—â–∏–Ω–∫–∏, –æ—Ç—á–µ—Ç–ª–∏–≤–æ –æ–±–æ–∑–Ω–∞—á–∞—è —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã. –ü—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Å–∫–≤–æ–∑–Ω—ã—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤ –º–µ—Ç–æ–¥ –º–æ–≥—É—Ç —Ç–∞–∫–∂–µ –Ω–∞–∑—ã–≤–∞—Ç—å ¬´—Ç–µ—á–µ–∏—Å–∫–∞–Ω–∏–µ–º¬ª.",
    ),
    Question(
        text="–í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–∞—Ö –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–µ–±—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç–∞. –ü–æ–∫—É–ø–∞—è –∞—Ä–±—É–∑, –µ–≥–æ –ø—Ä–æ—Å—Ç—É–∫–∏–≤–∞—é—Ç –∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –µ–≥–æ –∑—Ä–µ–ª–æ—Å—Ç—å. –≠—Ç–æ –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª—è. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ –∫—Ä—É–ø–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö –º–æ–∂–Ω–æ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –ø—Ä–∏–±–æ—Ä –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –ø–∏—Ç–∞–Ω–∏—è, –Ω–µ —Ä–∞–∑—Ä—É—à–∞—è –µ–≥–æ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å. –°—É—Ç—å –º–µ—Ç–æ–¥–∞, –ª–µ–∂–∞—â–µ–≥–æ –≤ –æ—Å–Ω–æ–≤–µ ‚Äì –ø—Ä–æ—Å–≤–µ—á–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –Ω–∞ —Å–≤–µ—Ç, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ —Å—Ç—Ä–æ–µ–Ω–∏–µ, —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å, –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–æ—Ä–æ–¥–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã. –ß—Ç–æ —ç—Ç–æ –∑–∞ –ø—Ä–æ–¥—É–∫—Ç.",
        options=["–ú–æ–ª–æ–∫–æ –≤ –∫–æ—Ä–æ–±–∫–µ", "–Ø–π—Ü–∞", "–¢—É—à—ë–Ω–∫–∞", "–°–æ–ª—ë–Ω—ã–µ –æ–≥—É—Ä—Ü—ã"],
        correct=1,
        hint_wrong="–°—Ö–æ–¥–∏ –≤ –º–∞–≥–∞–∑–∏–Ω –∏ –ø—Ä–æ–≤–µ—Ä—å",
        explain_right="—è–π—Ü–∞. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ö–æ–∑—è–π–∫–∏ –∑–Ω–∞—é—Ç –µ—â–µ –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Ä–∫–∏ —è–∏—Ü, –Ω–µ —Ä–∞–∑—Ä—É—à–∞—è –µ–≥–æ —Å–∫–æ—Ä–ª—É–ø—É. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç—å —è–π—Ü–∞ –≤ –ø–∏—â—É –º–æ–∂–Ω–æ –ø–æ —Å—Ç–µ–ø–µ–Ω–∏ –µ–≥–æ –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è –≤ –≤–æ–¥—É, –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —è–π—Ü–æ –≤—Å–ø–ª—ã–≤–µ—Ç, –∞ —Å–≤–µ–∂–µ–µ —É—Ç–æ–Ω–µ—Ç. –í–∞—Ä–µ–Ω–æ–µ —è–π—Ü–æ –∏–ª–∏ –Ω–µ—Ç —Ç–æ–∂–µ –º–æ–∂–Ω–æ –Ω–µ —Ä–∞–∑–±–∏–≤–∞—è –µ–≥–æ. –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å, —Å–ø—Ä–æ—Å–∏ —É –º–∞–º—ã. –ú–∞–º—ã –æ–Ω–∏ —Ç–æ–∂–µ –Ω–µ–º–Ω–æ–≥–æ –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç—ã.",
    ),
    Question(
        text="–ë–∞–±–∞ –í–∞–ª—è –ø–æ–ª—É—á–∏–ª–∞ –æ—Ç–ª–∏—á–Ω—ã–π —É—Ä–æ–∂–∞–π –æ–≥—É—Ä—Ü–æ–≤ –∏ —á–∞—Å—Ç—å –∏–∑ –Ω–∏—Ö —Ä–µ—à–∏–ª–∞ –∑–∞—Å–æ–ª–∏—Ç—å, –∞ —á–∞—Å—Ç—å –ø—É—Å—Ç–∏—Ç—å –Ω–∞ —Å–∞–ª–∞—Ç. –î–ª—è –∑–∞—Å–æ–ª–∫–∏ —Ç—Ä–µ–±–æ–≤–∞–ª–∏—Å—å –Ω–µ–∫—Ä—É–ø–Ω—ã–µ –æ–≥—É—Ä—á–∏–∫–∏, –±–µ–∑ —Ç—Ä–µ—â–∏–Ω, —Ü–∞—Ä–∞–ø–∏–Ω, —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –∑–µ–ª–µ–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ –±–µ–∑ –∂–µ–ª—Ç–∏–∑–Ω—ã. –ù–∞ —Å–∞–ª–∞—Ç –∂–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—É—Å—Ç–∏—Ç—å –≤—Å–µ, —á—Ç–æ –Ω–µ –ø–æ—à–ª–æ –≤ –∑–∞—Å–æ–ª–∫—É. –ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –æ—Ç–±—Ä–∞–∫–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –±–∞–±–∞ –í–∞–ª—è?",
        options=["–ú–∞–≥–Ω–∏—Ç–Ω—ã–π", "–£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π", "–í–∏–∑—É–∞–ª—å–Ω—ã–π", "–†–∞–¥–∏–∞—Ü–∏–æ–Ω–Ω—ã–π"],
        correct=2,
        hint_wrong="–ù—É —Ç—ã –æ—á–µ–Ω—å –±–ª–∏–∑–æ–∫, –Ω–æ –Ω–µ —Ç–æ—Ç –æ—Ç–≤–µ—Ç",
        explain_right="–±–∞–±–∞ –í–∞–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –∏ –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç–∞–º –±—ã—Å—Ç—Ä–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∏–∑—ä—è–Ω—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä —Å–≤–∞—Ä–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, —Ç–∞–∫–∏–µ –∫–∞–∫ –≤—ã–µ–º–∫–∏, –ø–æ–ª–æ—Å—Ç–∏, –∫–∞–≤–µ—Ä–Ω—ã, —Å–≤–∏—â–∏, —Ç—Ä–µ—â–∏–Ω—ã, —Å–∫–æ–ª—ã, —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–∏—è, –Ω–µ–ø—Ä–æ–≤–∞—Ä–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã, –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ —à–æ–≤–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è. –ë–∞–±–∞ –í–∞–ª—è —Ç–æ–∂–µ –≤ –¥—É—à–µ –±—ã–ª–∞ –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç–æ–º.",
    ),
    Question(
        text="–ú–∞–∫—Å –≠–π–∑–µ–Ω—Ö–∞—Ä–¥—Ç –∏–ª–∏ –≠—Ä–∏–∫ –ú–∞–≥–Ω—É—Å –õ–µ–Ω—à–µ—Ä—Ä ‚Äì –ø–µ—Ä—Å–æ–Ω–∞–∂ –∫–æ–º–∏–∫—Å–æ–≤ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ Marvel Comics. –í–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–ª—Å—è –≤ 1963 –≥–æ–¥—É –∫–∞–∫ –∑–∞–∫–ª—è—Ç—ã–π –≤—Ä–∞–≥ –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–∞ –ò–∫—Å –∏ –µ–≥–æ –∫–æ–º–∞–Ω–¥—ã –ª—é–¥–µ–π –ò–∫—Å. –û—Å–Ω–æ–≤–Ω–∞—è –µ–≥–æ —Å—É–ø–µ—Ä—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å ‚Äì —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–º–∏ –ø–æ–ª—è–º–∏, –æ–±–ª–∞–¥–∞–µ—Ç —Å–≤–µ—Ä—Ö—á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π —Å–∏–ª–æ–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –º–∞—Å—Ç–µ—Ä –±–æ–µ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–Ω –æ–±–ª–∞–¥–∞–µ—Ç –æ–±—à–∏—Ä–Ω—ã–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏ –≤ –≥–µ–Ω–µ—Ç–∏–∫–µ, —Ñ–∏–∑–∏–∫–µ –∏ –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏. –ï—Å–ª–∏ –±—ã –ú–∞–∫—Å –≠–π–∑–µ–Ω—Ö–∞—Ä–¥—Ç —Å—Ç–∞–ª –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç–æ–º, –Ω–∞ –∫–∞–∫–æ–π –≤–∏–¥ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –æ–Ω –±—ã –∞—Ç—Ç–µ—Å—Ç–æ–≤–∞–ª—Å—è –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å?",
        options=["–†–∞–¥–∏–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π", "–£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å", "–ú–∞–≥–Ω–∏—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å", "–ü–Ω–µ–≤–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–± –∫–æ–Ω—Ç—Ä–æ–ª—è"],
        correct=2,
        hint_wrong="–¢—ã –Ω–µ GeeK —Ä–∞–∑ –Ω–µ –∑–Ω–∞–µ—à—å –æ –∫–æ–º –∏–¥–µ—Ç —Ä–µ—á—å –∏–¥–∏ –ø–æ—á–∏—Ç–∞–π –∫–æ–º–∏–∫—Å—ã",
        explain_right="—Ä–µ—á—å –∏–¥–µ—Ç –æ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ –ø–æ–¥ –∏–º–µ–Ω–µ–º –ú–∞–≥–Ω–µ—Ç–æ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –º–∞–≥–Ω–∏—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, —Å—É—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –Ω–∞–º–∞–≥–Ω–∏—á–∏–≤–∞–Ω–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º–æ–≥–æ —É—á–∞—Å—Ç–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ –∏—Å–∫–∞–∂–µ–Ω–Ω–æ–≥–æ –º–∞–≥–Ω–∏—Ç–Ω–æ–≥–æ —Å–∏–ª–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞, –¥–ª—è –Ω–µ–≥–æ –¥–∞–∂–µ –Ω–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤.",
    ),
    Question(
        text="–í –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –í–æ–ª–∫–æ–≤–∞ ¬´–í–æ–ª—à–µ–±–Ω–∏–∫ –∏–∑—É–º—Ä—É–¥–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞¬ª –≥–µ—Ä–æ–∏ —Å—á–∏—Ç–∞–ª–∏ —Å–µ–±—è –¥–µ—Ñ–µ–∫—Ç–Ω—ã–º–∏ –∏ —à–ª–∏ –∫ –ì—É–¥–≤–∏–Ω—É, —á—Ç–æ–±—ã –æ–Ω –ø–æ–º–æ–≥ –∏–º. –ò –µ—Å–ª–∏ —É –õ—å–≤–∞ –∏ –°—Ç—Ä–∞—à–∏–ª—ã –ø—Ä–æ–±–ª–µ–º—ã —Å–∫–æ—Ä–µ–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ (–æ–¥–∏–Ω —Å—á–∏—Ç–∞–ª, —á—Ç–æ —É –Ω–µ–≥–æ –Ω–µ—Ç —Ö—Ä–∞–±—Ä–æ—Å—Ç–∏, –≤—Ç–æ—Ä–æ–π —Å—á–∏—Ç–∞–µ—Ç —á—Ç–æ —É –Ω–µ–≥–æ –Ω–µ—Ç –º–æ–∑–≥–æ–≤), —Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–µ—Ä–¥—Ü–∞ —É –ñ–µ–ª–µ–∑–Ω–æ–≥–æ –î—Ä–æ–≤–æ—Å–µ–∫–∞ - —Å–∫–æ—Ä–µ–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–π –±—Ä–∞–∫, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç. –ö–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –æ–Ω –º–æ–≥ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?",
        options=["–í–∏–∑—É–∞–ª—å–Ω—ã–π", "–£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π", "–ú–∞–≥–Ω–∏—Ç–Ω—ã–π", "–†–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏–π"],
        correct=1,
        hint_wrong="–¢—ã –æ—á–µ–Ω—å –±–ª–∏–∑–æ–∫ –Ω–µ —Å–¥–∞–≤–∞–π—Å—è",
        explain_right="–≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏ –º–∞–≥–Ω–∏—Ç–Ω—ã–π –º–µ—Ç–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤. –ó–¥–µ—Å—å —Ä–µ—á—å —Å–∫–æ—Ä–µ–µ –ø–æ–¥–æ–π–¥–µ—Ç —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –∏–ª–∏ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏–π –º–µ—Ç–æ–¥.",
    ),
    Question(
        text="–ü–æ –≤–µ—Ä—Å–∏–∏ –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç–æ–≤ –≤ —Å–∫–∞–∑–∫–µ ¬´–ö—É—Ä–æ—á–∫–∞ –†—è–±–∞¬ª –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –æ–¥–∏–Ω –∏–∑ –º–µ—Ç–æ–¥–æ–≤ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ –∑–æ–ª–æ—Ç–æ–≥–æ —è–∏—á–∫–∞. –ú—ã—à–∫–∞ –∂–µ, –Ω–µ –æ–±–ª–∞–¥–∞—è –≥–ª—É–±–æ–∫–∏–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏ –æ –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –º–µ—Ç–æ–¥ —Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è, —Ä–∞–∑–±–∏–≤ —è–π—Ü–æ, –Ω–µ —Ä–∞–∑–æ–±—Ä–∞–≤—à–∏—Å—å —Å –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏. –ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –¥–µ–¥ –∏ –±–∞–±–∞?",
        options=["–ê–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–π", "–í–∏–∑—É–∞–ª—å–Ω—ã–π", "–ì–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π", "–ú–∞–≥–Ω–∏—Ç–Ω—ã–π"],
        correct=0,
        hint_wrong="–ù–µ —Ç–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥",
        explain_right="–∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–π. –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –¥–µ–¥ –∏ –±–∞–±–∞ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ ¬´–ø—Ä–æ—Å—Ç—É–∫–∏–≤–∞–ª–∏¬ª –∑–æ–ª–æ—Ç–æ–µ —è–∏—á–∫–æ –∏ —Å–ª—É—à–∞–ª–∏ –∏—Å–∫–∞–∂–µ–Ω–∏—è –∑–≤—É–∫–∞, –∫–∞–∫ –æ–±—Ö–æ–¥—á–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –¥–µ—Ñ–µ–∫—Ç—ã —Ä–µ–ª—å—Å, —É–¥–∞—Ä—è—è –ø–æ –Ω–∏–º –º–æ–ª–æ—Ç–∫–æ–º. –Ø–∏—á–∫–æ –±—ã–ª–æ –±–µ–∑ –¥–µ—Ñ–µ–∫—Ç–æ–≤, –Ω–æ –æ—á–µ–Ω—å —Ö—Ä—É–ø–∫–æ–µ.",
    ),
    Question(
        text="–í –æ–¥–Ω–æ–π –∏–∑ —Å–∫–∞–∑–æ–∫ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –†–æ—É –≥–µ—Ä–æ–π –¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–∞—Ç—å —Å–≤–æ—é –±—É–¥—É—â—É—é –Ω–µ–≤–µ—Å—Ç—É —Å—Ä–µ–¥–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–æ–ø–∏–π. –í–∏–∑—É–∞–ª—å–Ω–æ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –Ω–æ –≥–µ—Ä–æ–π –≤—Å–µ-—Ç–∞–∫–∏ —Å–ø—Ä–∞–≤–∏–ª—Å—è. –ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–æ–º–æ–≥ –µ–º—É –≤ —ç—Ç–æ–º?",
        options=["–í–∏–∑—É–∞–ª—å–Ω—ã–π", "–ê–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–π", "–¢–µ–ø–ª–æ–≤–æ–π", "–†–∞–¥–∏–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π"],
        correct=2,
        hint_wrong="–ö–∞–∂–µ—Ç—Å—è, –∫—Ç–æ-—Ç–æ –Ω–µ —á–∏—Ç–∞–ª –¥–∞–Ω–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ",
        explain_right="—Ç–µ–ø–ª–æ–≤–æ–π. –û—Ç –∂–∏–≤–æ–π –¥–µ–≤—É—à–∫–∏ —à–ª–æ —Ç–µ–ø–ª–æ, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –∫–æ–ø–∏–∏ –±—ã–ª–∏ —Ö–æ–ª–æ–¥–Ω—ã–º–∏. –ú–∞–º—ã, –¥–∞–∂–µ –Ω–µ –±—É–¥—É—á–∏ –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç–∞–º–∏, —Ç–æ–∂–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç —ç—Ç–æ—Ç –º–µ—Ç–æ–¥, –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞—è –ª–∞–¥–æ–Ω—å –∫–æ –ª–±—É –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Ç–µ–ª–∞ —Ä–µ–±–µ–Ω–∫–∞.",
    ),
    Question(
        text="–í –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–º –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–º –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ –†.–†. –¢–æ–ª–∫–∏–Ω–∞ –≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Ä–∞–∑–≤–∏–≤–∞—é—Ç—Å—è –≤–æ–∫—Ä—É–≥ –∫–æ–ª—å—Ü–∞ –≤—Å–µ–≤–ª–∞—Å—Ç–∏—è. –ù–∞–¥–µ–≤–∞—è –∫–æ–ª—å—Ü–æ –§—Ä–æ–¥–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–≤–∏–¥–∏–º. –ö–æ–ª—å—Ü–æ –≤–µ—Ä–æ—è—Ç–Ω–æ —Å–º–µ—â–∞–ª–æ –æ–ø—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –æ–±–ª–∞–¥–∞—Ç–µ–ª—è –≤ –Ω–µ–≤–∏–¥–∏–º—É—é –≥–ª–∞–∑—É –æ–±—ã—á–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –æ–±–ª–∞—Å—Ç—å. –ü—Ä–∏ —ç—Ç–æ–º –æ–∫—Ä—É–∂–∞—é—â–∞—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–µ–Ω—è–ª–∞ —Å–≤–æ–∏ –æ–ø—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –∏ –æ–±–ª–∞–¥–∞—Ç–µ–ª—å –∫–æ–ª—å—Ü–∞ —Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –≤–∏–¥–∏–º –¥–ª—è –í—Å–µ–≤–∏–¥—è—â–µ–≥–æ –æ–∫–∞. –°–æ–≥–ª–∞—Å–Ω–æ —Ä–∞—Å—á–µ—Ç–∞–º, —Å–¥–µ–ª–∞–Ω–Ω—ã–º —ç–Ω—Ç—É–∑–∏–∞—Å—Ç–∞–º–∏, —Ä–µ—á—å –∏–¥–µ—Ç –æ –∏–Ω—Ñ—Ä–∞–∫—Ä–∞—Å–Ω–æ–º –∏–∑–ª—É—á–µ–Ω–∏–∏. –ü—Ä–∏—Å—Ç–∞–≤–∫–∞ ¬´–∏–Ω—Ñ—Ä–∞-¬ª (–æ—Ç –ª–∞—Ç. infra-) –æ–∑–Ω–∞—á–∞–µ—Ç ¬´—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥ —á–µ–º-–ª–∏–±–æ, –Ω–∏–∂–µ —á–µ–≥–æ-–ª–∏–±–æ¬ª.  –ö–∞–∫–æ–π –µ—â–µ –≤–∏–¥ –∏–∑–ª—É—á–µ–Ω–∏—è, –Ω–µ –≤–∏–¥–∏–º—ã–π –¥–ª—è —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –≥–ª–∞–∑–∞, –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–µ.",
        options=["–£–ª—å—Ç—Ä–∞—á—ë—Ä–Ω—ã–π", "–ò–Ω—Ñ—Ä–∞—Å–∏–Ω–∏–π", "–ü—Ä–æ—Å—Ç–æ –±–µ–ª—ã–π", "–£–ª—å—Ç—Ä–∞—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π"],
        correct=3,
        hint_wrong="–¥–µ—Ç–µ–∫—Ç–∏–≤—ã –≤ —Ñ–∏–ª—å–º–∞—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ –∏–∑–ª—É—á–µ–Ω–∏–µ —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Å–ª–µ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–∏–¥–Ω–æ.",
        explain_right="—É–ª—å—Ç—Ä–∞—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π. –î–∏–∞–ø–∞–∑–æ–Ω –≤–∏–¥–∏–º–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–æ–º —Å–≤–µ—Ç–∞ –∫–æ–ª–µ–±–ª–µ—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–ª–∏–Ω –≤–æ–ª–Ω –æ—Ç 380 –¥–æ 780 –Ω–ú. –ü—Ä–∏—Å—Ç–∞–≤–∫–∞ ¬´—É–ª—å—Ç—Ä–∞-¬ª, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç –ª–∞—Ç–∏–Ω—Å–∫–æ–≥–æ ultra ‚Äî ¬´–¥–∞–ª—å—à–µ, –¥–∞–ª–µ–µ¬ª –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ —á–µ–≥–æ-–ª–∏–±–æ, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–µ–¥–µ–ª—ã –≤–∏–¥–∏–º–æ–≥–æ —Å–≤–µ—Ç–∞. –ù–æ —ç—Ç–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —á–µ–ª–æ–≤–µ–∫–∞. –ü—Ç–∏—Ü—ã –∏ –Ω–∞—Å–µ–∫–æ–º—ã–µ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –≤–∏–¥—è—Ç –∏ –≤ —É–ª—å—Ç—Ä–∞—Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ.",
    ),
    Question(
        text="–í—Å–µ–º –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –≤ –ø—Ä–∏—Ä–æ–¥–µ —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –ª—É—á—à–µ –≤—Å–µ—Ö –≤–ª–∞–¥–µ—é—Ç –ª–µ—Ç—É—á–∏–µ –º—ã—à–∏. –í —Ç–µ–º–Ω—ã—Ö –ø–µ—â–µ—Ä–∞—Ö –º—ã—à–∏ —Å–∫–∞–Ω–∏—Ä—É—é—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –∏—Å–ø—É—Å–∫–∞—è –£–ó –∏–º–ø—É–ª—å—Å—ã, –ø—Ä–æ–≤–µ—Ä—è—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞ –Ω–µ–æ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç–∏ –ò–∑–ª—É—á–∞—Ç–µ–ª–µ–º —Å–ª—É–∂–∞—Ç –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–≤—è–∑–∫–∏, –≤–æ–ª–Ω–∞ –º–æ–∂–µ—Ç –∏—Å–ø—É—Å–∫–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ —Ä–æ—Ç –∏–ª–∏ –Ω–æ—Å. –ü—Ä–∏–µ–º–Ω–∏–∫–æ–º —Å–ª—É–∂–∞—Ç —É—à–Ω—ã–µ —Ä–∞–∫–æ–≤–∏–Ω—ã. –õ–µ—Ç—É—á–∞—è –º—ã—à—å ‚Äì —ç—Ç–æ –ø—Ä–∏—Ä–æ–¥–Ω—ã–π –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø. –†–µ–¥–∫–æ –±—ã–≤–∞–µ—Ç, —á—Ç–æ –æ—Ö–æ—Ç–Ω–∏—Ü—ã –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –¥–æ–±—ã—á–∏. –ß—Ç–æ –º–æ–∂–µ—Ç –º–µ—à–∞—Ç—å ¬´—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é¬ª?",
        options=["–°–æ–ª–Ω–µ—á–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", "–í–µ—Ç–µ—Ä", "–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è", "–í–ª–∞–∂–Ω–æ—Å—Ç—å"],
        correct=3,
        hint_wrong="–¢—É—Ç —Ç–∞–∫–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤–æ–ª–Ω—ã –æ—Ç—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è –æ—Ç –≤—Å–µ–≥–æ",
        explain_right="–ø–æ–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è ‚Äì –ø–æ–≤—ã—à–µ–Ω–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å. –ù–∞ –∫–∞–ø–ª—è—Ö –≤–æ–¥—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏–µ –£–ó-–≤–æ–ª–Ω—ã, –∫—Ä—É–ø–Ω—ã–µ –∫–∞–ø–ª–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ª–æ–∂–Ω–æ –≤–æ—Å–ø—Ä–∏–Ω—è—Ç—ã –∫–∞–∫ –Ω–∞—Å–µ–∫–æ–º–æ–µ.",
    ),
    Question(
        text="–û–¥–∏–Ω –∏–∑ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å—É–ø–µ—Ä–≥–µ—Ä–æ–µ–≤ –Ω–æ—Å–∏—Ç –∏–º—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–≤–æ–¥–∏—Ç –Ω–∞ –º—ã—Å–ª—å –æ —Ç–æ–º, —Ç–æ –æ–Ω –∏–º–µ–µ—Ç –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –£–ó-–¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∞–º–∏. –ü–æ –ª–µ–≥–µ–Ω–¥–µ, –æ–Ω –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —Å–∫–≤–æ–∑—å —Å—Ç–µ–Ω—ã, –Ω–æ –ø—Ä–∏—Ä–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è —ç—Ç–æ–≥–æ –ª—É—á–µ–π —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω–∞—è. –û–±—Ä–∞–∑ –≥–µ—Ä–æ—è —Ç–æ–∂–µ –º–æ–∂–µ—Ç –≤–≤–æ–¥–∏—Ç—å –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ, –Ω–æ —Ç–æ–ª—å–∫–æ –Ω–µ —Ç–æ–≥–æ, –∫—Ç–æ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Ñ–∏–∑–∏–∫–µ. –ù–∞–∑–æ–≤–∏—Ç–µ –µ–≥–æ.",
        options=["–•–∞–ª–∫", "–°—É–ø–µ—Ä–º–µ–Ω", "–ë—ç—Ç–º–µ–Ω", "–ß–µ–ª–æ–≤–µ–∫-–ø–∞—É–∫"],
        correct=2,
        hint_wrong="–û–Ω —É–∂–∞—Å –≤–æ —Ç—å–º–µ –Ω–æ—á–Ω–æ–π.",
        explain_right="–ë—ç—Ç–º–µ–Ω. –•–æ—Ç—å —ç—Ç–æ –∏ –ß–µ–ª–æ–≤–µ–∫-–ª–µ—Ç—É—á–∞—è –º—ã—à—å, –Ω–∞–≤—ã–∫–∞–º–∏ —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –∏–Ω—Ç—Ä–æ—Å–∫–æ–ø–∏–∏ –æ–Ω –Ω–µ –æ–±–ª–∞–¥–∞–µ—Ç. –£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤—ã–µ –≤–æ–ª–Ω—ã –ø–æ —Å–≤–æ–µ–π –ø—Ä–∏—Ä–æ–¥–µ —è–≤–ª—è—é—Ç—Å—è –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–º–∏.",
    ),
    Question(
        text="–≠—Ç–∏–º –≤–∏–¥–æ–º –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å–µ –º–∞–ª—å—á–∏—à–∫–∏ –∏ –¥–µ–≤—á–æ–Ω–∫–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –≤–µ–ª–æ—Å–∏–ø–µ–¥. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–π—Ç–∏ —Å–∫–≤–æ–∑–Ω—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã –Ω–∞ –æ–±—ä–µ–∫—Ç–∞—Ö, –≥–¥–µ –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤–∞–∂–Ω–µ–π—à–∏–º —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ–º. –£ –≤–µ–ª–æ—Å–∏–ø–µ–¥–æ–≤ –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–∞ –¥–ª—è –∫–∞–º–µ—Ä—ã –∫–æ–ª–µ—Å–∞. –ï—Å–ª–∏ –∫–æ–ª–µ—Å–æ –Ω–∞—á–∞–ª–æ —Å–ø—É—Å–∫–∞—Ç—å, —Ç–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∫–∞–º–µ—Ä—ã –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω–∞–∫–∞—á–∞–≤ –µ–µ –≤–æ–∑–¥—É—Ö–æ–º –∏ –æ–ø—É—Å—Ç–∏–≤ –≤ —Ç–∞–∑ —Å –≤–æ–¥–æ–π. –í –ø–æ–ª–µ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –∫–∞–ø–ª—é –≤–æ–¥—ã –∫–∞–ø–∞—é—Ç –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ. –ï—Å–ª–∏ –≤–æ–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø—É–∑—ã—Ä–∏—Ç—å—Å—è, –∑–Ω–∞—á–∏—Ç –∫–∞–º–µ—Ä–∞ –ø—Ä–æ–∫–æ–ª–æ—Ç–∞. –ß—Ç–æ —ç—Ç–æ –∑–∞ –º–µ—Ç–æ–¥?",
        options=["–í–∏–∑—É–∞–ª—å–Ω—ã–π", "–¢–µ—á–µ–∏—Å–∫–∞–Ω–∏–µ", "–£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π", "–¢–µ–ø–ª–æ–≤–æ–π"],
        correct=1,
        hint_wrong="–ï—Å–ª–∏ –∏–∑ —Ç—Ä—É–±—ã –∫–∞–ø–∞–µ—Ç –≤–æ–¥–∞, —á—Ç–æ —ç—Ç–æ?",
        explain_right="—Ç–µ—á–µ–∏—Å–∫–∞–Ω–∏–µ. –ú–µ—Ç–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤–µ—â–µ—Å—Ç–≤, –ø—Ä–æ–Ω–∏–∫–∞—é—â–∏—Ö —á–µ—Ä–µ–∑ —Ç–µ—á–∏ ‚Äì –∫–∞–Ω–∞–ª—ã –∏–ª–∏ –ø–æ—Ä–∏—Å—Ç—ã–µ —É—á–∞—Å—Ç–∫–∏, –Ω–∞—Ä—É—à–∞—é—â–∏–µ –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø—É–∑—ã—Ä—å–∫–æ–≤—ã–π –º–µ—Ç–æ–¥",
    ),
    Question(
        text="–≠—Ç–æ—Ç –≤–∏–¥ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –æ—á–µ–Ω—å —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ –≤–æ–∫–∑–∞–ª–∞—Ö –∏ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞—Ö. –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ç–æ–º, —á—Ç–æ –∏–∑–ª—É—á–µ–Ω–∏–µ, –ø—Ä–æ–Ω–∏–∫–∞—è —á–µ—Ä–µ–∑ –æ–±—ä–µ–∫—Ç, –ø–æ–≥–ª–æ—â–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞, –¥–∞—Ç—á–∏–∫–∏ —É–ª–∞–≤–ª–∏–≤–∞—é—Ç –ø—Ä–æ—à–µ–¥—à–∏–µ –ª—É—á–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç –∏—Ö –≤ —Ü–∏—Ñ—Ä–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω. –ö–∞–∫–æ–π –ø—Ä–∏–±–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?",
        options=["–£–ó-–¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø", "–û—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ", "–†–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏–π —Å–∫–∞–Ω–µ—Ä", "–í–æ–ª—å—Ç–º–µ—Ç—Ä"],
        correct=2,
        hint_wrong="–ö–∞–∂–¥—ã–π –≥–æ–¥ –ª—é–¥–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —ç—Ç—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É –≤ –±–æ–ª—å–Ω–Ω–∏—Ü–µ, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–µ–≥–∫–∏–µ",
        explain_right="—Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏–π —Å–∫–∞–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–≥–∞–∂–∞ –Ω–∞ –æ–ø–∞—Å–Ω—ã–µ –∏ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∫ –ø—Ä–æ–≤–æ–∑—É –ø—Ä–µ–¥–º–µ—Ç—ã. –†–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏–π —Å–∫–∞–Ω–µ—Ä –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã, –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –≤–µ—â–µ—Å—Ç–≤–∞, —Å–ø—Ä—è—Ç–∞–Ω–Ω—ã–µ –ø–æ–¥ –æ–¥–µ–∂–¥–æ–π.",
    ),
    Question(
        text="–≠—Ç–æ—Ç –ø—Ä–∏–±–æ—Ä –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å –≤ –æ–±—ã—á–Ω–æ–π —à–∫–æ–ª–µ. –ú–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª–æ–∂–µ–Ω –≤ –æ—Å–Ω–æ–≤—É –µ–≥–æ —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–Ω–∂–µ–Ω–µ—Ä—ã –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –≤ –ø–æ—Ä–æ—à–∫–æ–≤–æ–π –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ—Ä –∏ —Ç—Ä–µ—â–∏–Ω –≤ –¥–µ—Ç–∞–ª—è—Ö. –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ –≤ –∑–æ–Ω—É –¥–µ–π—Å—Ç–≤–∏—è –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ–≥–æ –º–∞–≥–Ω–∏—Ç–Ω–æ–≥–æ –ø–æ–ª—è –≤–æ–∑–Ω–∏–∫–∞—é—Ç –≤–∏—Ö—Ä–µ–≤—ã–µ —Ç–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—Ç–æ—Ä–∏—á–Ω–æ–µ —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω–æ–µ –ø–æ–ª–µ. –î–µ—Ç–µ–∫—Ç–æ—Ä —É–ª–∞–≤–ª–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–º —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω–æ–º –ø–æ–ª–µ. –í —à–∫–æ–ª–µ –æ–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–∏—â–∞—Ç—å, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—è –æ–± –æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ß—Ç–æ —ç—Ç–æ –∑–∞ –ø—Ä–∏–±–æ—Ä?",
        options=["–¢–µ—Ä–º–æ–º–µ—Ç—Ä", "–°–∏—Å—Ç–µ–º–∞ –ø–æ–∂–∞—Ä–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏", "–ú–µ—Ç–∞–ª–ª–æ–¥–µ—Ç–µ–∫—Ç–æ—Ä", "–¢—Ä–µ–≤–æ–∂–Ω–∞—è –∫–Ω–æ–ø–∫–∞"],
        correct=2,
        hint_wrong="–ò—Å–ø–æ–ª—å–∑—É—é—Ç –ª—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—â—É—Ç —Å–æ–∫—Ä–æ–≤–∏—â–∞.",
        explain_right="–ê–±—Å–æ–ª—é—Ç–Ω–æ –≤–µ—Ä–Ω–æ –º–æ–π –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥ —ç—Ç–æ –ú–µ—Ç–∞–ª–ª–æ–¥–µ—Ç–µ–∫—Ç–æ—Ä",
    ),
    Question(
        text="–ê–¥–≤–æ–∫–∞—Ç –ú—ç—Ç—Ç –ú—ë—Ä–¥–æ–∫ –ø–æ –ø—Ä–æ–∑–≤–∏—â—É –°–æ—Ä–≤–∏–≥–æ–ª–æ–≤–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –∫–æ–º–∏–∫—Å—É Marvel –ø–æ–ø–∞–ª –ø–æ–¥ –¥–µ–π—Å—Ç–≤–∏–µ —Ä–∞–¥–∏–æ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–µ—â–µ—Å—Ç–≤–∞ –∏ –ø–æ—Ç–µ—Ä—è–ª –∑—Ä–µ–Ω–∏–µ. –ü—Ä–∏ —ç—Ç–æ–º —É –Ω–µ–≥–æ —Ä–∞–∑–≤–∏–ª–æ—Å—å ¬´—Ä–∞–¥–∞—Ä–Ω–æ–µ —á—É—Ç—å–µ¬ª —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ –æ–Ω –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∏—Ä –≤–æ–∫—Ä—É–≥. –≠—Ç–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å–æ —Å–≤–µ—Ä—Ö—á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π —Å–µ–Ω—Å–æ—Ä–Ω–æ–π, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç —Ç–∞–∫—Ç–∏–ª—å–Ω—É—é —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –º–∞–ª–µ–π—à–∏–º –Ω–µ—Ä–æ–≤–Ω–æ—Å—Ç—è–º, –æ–±–æ–Ω—è–Ω–∏–µ –∏ —Å–ª—É—Ö (–æ–Ω —Å–ª—ã—à–∏—Ç –±–∏–µ–Ω–∏–µ —Å–µ—Ä–¥—Ü–∞ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞). –°–ø–æ—Å–æ–±, –∫–æ—Ç–æ—Ä—ã–π –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω —Ç–æ–º—É, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤ —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏–∏. –ß—Ç–æ —ç—Ç–æ –∑–∞ –º–µ—Ç–æ–¥?",
        options=["–¢–µ–Ω–µ–≤–æ–π", "–ó–µ—Ä–∫–∞–ª—å–Ω—ã–π", "–î–∏—Ñ—Ä–∞–∫—Ü–∏–æ–Ω–Ω–æ-–≤—Ä–µ–º–µ–Ω–Ω–æ–π", "–≠—Ö–æ-–º–µ—Ç–æ–¥"],
        correct=3,
        hint_wrong="–í –≥–æ—Ä–∞—Ö —á–∞—Å—Ç–æ –ª—é–¥–∏ –∫—Ä–∏—á–∞—Ç —á—Ç–æ–±—ã —É—Å–ª—ã—à–∞—Ç—å —ç—Ç–æ.",
        explain_right="—ç—Ö–æ-–º–µ—Ç–æ–¥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–ª–µ–±–∞–Ω–∏—è –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ—Ç—Ä–∞–∂–µ–Ω–Ω—ã–µ –æ—Ç –¥–µ—Ñ–µ–∫—Ç–æ–≤ —ç—Ö–æ-—Å–∏–≥–Ω–∞–ª—ã. –†–∞–∑–º–µ—Ä—ã –∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–∞ –æ—Ü–µ–Ω–∏–≤–∞—é—Ç –ø–æ –∞–º–ø–ª–∏—Ç—É–¥–µ –∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–¥–µ—Ä–∂–∫–∏ –æ—Ç—Ä–∞–∂–µ–Ω–Ω–æ–≥–æ —ç—Ö–æ-—Å–∏–≥–Ω–∞–ª–∞. –ú—ë—Ä–¥–æ–∫ –¥–µ–ª–∞–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–æ–∂–µ —Å–∞–º–æ–µ. –û–Ω –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —â–µ–ª—á–∫–∏, —Ç–µ–º —Å–∞–º—ã–º –ø–æ—Å—ã–ª–∞—è –∑–≤—É–∫–æ–≤—ã–µ –∏–º–ø—É–ª—å—Å—ã –∏ —Å–ª—É—à–∞–µ—Ç –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ.",
    ),
    Question(
        text="–î–∞–π—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω—É –ë—Ä–∞–∫",
        options=["–Ω–∞–ª–∏—á–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è", "–Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑-–∑–∞ –Ω–∞–ª–∏—á–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤", "–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º", "–Ω–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞"],
        correct=1,
        hint_wrong="—Ç—ã —Å–ø—Ä–∞–≤–∏—à—å—Å—è",
        explain_right="–≤–æ–ø—Ä–æ—Å —Å–ª–æ–∂–Ω—ã–π –∏ –æ—Ç–≤–µ—Ç—ã –Ω–µ –ø–æ–ª–Ω—ã–µ. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –±—Ä–∞–∫ - —ç—Ç–æ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –ø–∞—Å–ø–æ—Ä—Ç—É –∏ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑-–∑–∞ –Ω–∞–ª–∏—á–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤.",
    ),
    # ‚ö†Ô∏è –í–û–¢ –ó–î–ï–°–¨ –¢–í–û–ô –°–ü–ò–°–û–ö –í –°–û–û–ë–©–ï–ù–ò–ò –û–ë–û–†–í–ê–ù.
    # –î–∞–ª—å—à–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–∞–π –¥–æ–±–∞–≤–ª—è—Ç—å Question(...),
]
# ==========================================================
# ====================== –ö–û–ù–ï–¶ –í–û–ü–†–û–°–û–í ====================
# ==========================================================


# ==========================================================
# ====================== –£–¢–ò–õ–ò–¢–´ ===========================
# ==========================================================
def now_ts() -> int:
    return int(time.time())

def is_admin(update: Update) -> bool:
    u = update.effective_user
    return bool(u and u.id in ADMIN_IDS)

def chunk_text(text: str, max_chars: int = 900) -> List[str]:
    s = (text or "").strip()
    if not s:
        return ["(–¢–µ–æ—Ä–∏—è –ø–æ–∫–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞)"]
    paragraphs = [p.strip() for p in s.split("\n\n") if p.strip()]
    pages: List[str] = []
    buf = ""
    for p in paragraphs:
        candidate = (buf + "\n\n" + p).strip() if buf else p
        if len(candidate) <= max_chars:
            buf = candidate
        else:
            if buf:
                pages.append(buf)
                buf = ""
            while len(p) > max_chars:
                pages.append(p[:max_chars])
                p = p[max_chars:]
            buf = p
    if buf:
        pages.append(buf)
    return pages

def fmt_ms(ms: int) -> str:
    sec = ms / 1000.0
    m = int(sec // 60)
    s = sec - 60 * m
    return f"{m}:{s:06.3f}"

def build_quiz_order() -> List[int]:
    if len(QUESTIONS) < QUESTIONS_PER_RUN:
        raise RuntimeError(f"–í QUESTIONS={len(QUESTIONS)} –≤–æ–ø—Ä–æ—Å–æ–≤, –Ω–æ QUESTIONS_PER_RUN={QUESTIONS_PER_RUN}. –î–æ–±–∞–≤—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ —É–º–µ–Ω—å—à–∏ QUESTIONS_PER_RUN.")
    return random.sample(range(len(QUESTIONS)), k=QUESTIONS_PER_RUN)

def total_time_ms(context: ContextTypes.DEFAULT_TYPE) -> int:
    t0 = float(context.user_data.get("t0", time.time()))
    penalty = int(context.user_data.get("penalty_ms", 0))
    base = int((time.time() - t0) * 1000)
    return base + penalty

async def send(update: Update, text: str, reply_markup=None):
    if update.callback_query:
        await update.callback_query.message.reply_text(text, reply_markup=reply_markup)
    else:
        await update.message.reply_text(text, reply_markup=reply_markup)

async def send_photo(update: Update, path: str, caption: str, reply_markup=None):
    with open(path, "rb") as f:
        if update.callback_query:
            await update.callback_query.message.reply_photo(photo=f, caption=caption, reply_markup=reply_markup)
        else:
            await update.message.reply_photo(photo=f, caption=caption, reply_markup=reply_markup)

# ==========================================================
# ====================== POSTGRES ==========================
# ==========================================================
def db_connect():
    if not DATABASE_URL:
        raise RuntimeError("DATABASE_URL –Ω–µ –∑–∞–¥–∞–Ω (Railway Variables).")
    return psycopg.connect(DATABASE_URL, row_factory=dict_row)

def db_init():
    with db_connect() as con, con.cursor() as cur:
        cur.execute("""
            CREATE TABLE IF NOT EXISTS users (
                user_id BIGINT PRIMARY KEY,
                username TEXT,
                full_name TEXT,
                first_seen_ts BIGINT NOT NULL,
                last_seen_ts BIGINT NOT NULL
            )
        """)
        cur.execute("""
            CREATE TABLE IF NOT EXISTS events (
                id BIGSERIAL PRIMARY KEY,
                ts BIGINT NOT NULL,
                user_id BIGINT NOT NULL,
                event_type TEXT NOT NULL,
                payload_json TEXT
            )
        """)
        cur.execute("""
            CREATE TABLE IF NOT EXISTS attempts (
                id BIGSERIAL PRIMARY KEY,
                user_id BIGINT NOT NULL,
                started_ts BIGINT NOT NULL,
                ended_ts BIGINT,
                status TEXT NOT NULL, -- started|finished|quit
                questions_per_run INT NOT NULL,
                wrong_penalty_ms INT NOT NULL,
                wrong_count INT NOT NULL DEFAULT 0,
                penalty_ms INT NOT NULL DEFAULT 0,
                elapsed_ms INT,
                total_ms INT
            )
        """)
        cur.execute("""
            CREATE TABLE IF NOT EXISTS answers (
                id BIGSERIAL PRIMARY KEY,
                attempt_id BIGINT NOT NULL,
                user_id BIGINT NOT NULL,
                ts BIGINT NOT NULL,
                pos INT NOT NULL,
                question_index INT NOT NULL,
                option_index INT NOT NULL,
                is_correct BOOLEAN NOT NULL,
                penalty_ms_after INT NOT NULL,
                total_ms_now INT NOT NULL
            )
        """)
        con.commit()

def upsert_user(u) -> Tuple[int, Optional[str], Optional[str]]:
    uid = int(u.id)
    username = u.username
    full_name = u.full_name
    ts = now_ts()
    with db_connect() as con, con.cursor() as cur:
        cur.execute("SELECT user_id FROM users WHERE user_id=%s", (uid,))
        row = cur.fetchone()
        if row is None:
            cur.execute(
                "INSERT INTO users(user_id, username, full_name, first_seen_ts, last_seen_ts) VALUES(%s,%s,%s,%s,%s)",
                (uid, username, full_name, ts, ts),
            )
        else:
            cur.execute(
                "UPDATE users SET username=%s, full_name=%s, last_seen_ts=%s WHERE user_id=%s",
                (username, full_name, ts, uid),
            )
        con.commit()
    return uid, username, full_name

def log_event(user_id: int, event_type: str, payload_json: Optional[str] = None) -> None:
    with db_connect() as con, con.cursor() as cur:
        cur.execute(
            "INSERT INTO events(ts, user_id, event_type, payload_json) VALUES(%s,%s,%s,%s)",
            (now_ts(), user_id, event_type, payload_json),
        )
        con.commit()

def attempt_start(user_id: int) -> int:
    with db_connect() as con, con.cursor() as cur:
        cur.execute(
            """
            INSERT INTO attempts(user_id, started_ts, status, questions_per_run, wrong_penalty_ms)
            VALUES(%s,%s,%s,%s,%s)
            RETURNING id
            """,
            (user_id, now_ts(), "started", QUESTIONS_PER_RUN, WRONG_PENALTY_MS),
        )
        attempt_id = int(cur.fetchone()["id"])
        con.commit()
        return attempt_id

def attempt_update_progress(attempt_id: int, wrong_count: int, penalty_ms: int) -> None:
    with db_connect() as con, con.cursor() as cur:
        cur.execute("UPDATE attempts SET wrong_count=%s, penalty_ms=%s WHERE id=%s",
                    (wrong_count, penalty_ms, attempt_id))
        con.commit()

def attempt_finish(attempt_id: int, status: str, elapsed_ms: int, penalty_ms: int, wrong_count: int) -> None:
    total = elapsed_ms + penalty_ms
    with db_connect() as con, con.cursor() as cur:
        cur.execute(
            """
            UPDATE attempts
            SET ended_ts=%s, status=%s, elapsed_ms=%s, penalty_ms=%s, wrong_count=%s, total_ms=%s
            WHERE id=%s
            """,
            (now_ts(), status, elapsed_ms, penalty_ms, wrong_count, total, attempt_id),
        )
        con.commit()

def log_answer(attempt_id: int, user_id: int, pos: int, question_index: int, option_index: int,
               is_correct: bool, penalty_ms_after: int, total_ms_now: int) -> None:
    with db_connect() as con, con.cursor() as cur:
        cur.execute(
            """
            INSERT INTO answers(attempt_id, user_id, ts, pos, question_index, option_index, is_correct, penalty_ms_after, total_ms_now)
            VALUES(%s,%s,%s,%s,%s,%s,%s,%s,%s)
            """,
            (attempt_id, user_id, now_ts(), pos, question_index, option_index, is_correct, penalty_ms_after, total_ms_now),
        )
        con.commit()

def db_clear_all() -> None:
    with db_connect() as con, con.cursor() as cur:
        cur.execute("TRUNCATE TABLE answers RESTART IDENTITY")
        cur.execute("TRUNCATE TABLE attempts RESTART IDENTITY")
        cur.execute("TRUNCATE TABLE events RESTART IDENTITY")
        cur.execute("TRUNCATE TABLE users RESTART IDENTITY")
        con.commit()

# ==========================================================
# ====================== –õ–ò–î–ï–†–´ ============================
# –õ—É—á—à–∏–π total_ms –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
# ==========================================================
def leaderboard_top(limit: int = 10) -> List[Tuple[str, int]]:
    with db_connect() as con, con.cursor() as cur:
        cur.execute("""
            SELECT COALESCE(u.username, u.full_name, u.user_id::text) AS name,
                   MIN(a.total_ms) AS best_total
            FROM attempts a
            JOIN users u ON u.user_id = a.user_id
            WHERE a.status='finished' AND a.total_ms IS NOT NULL
            GROUP BY a.user_id, name
            ORDER BY best_total ASC
            LIMIT %s
        """, (limit,))
        rows = cur.fetchall()
    return [(r["name"], int(r["best_total"])) for r in rows]

# ==========================================================
# ====================== STATS (ADMIN) =====================
# ==========================================================
def stats_overview_text() -> str:
    with db_connect() as con, con.cursor() as cur:
        cur.execute("SELECT COUNT(*) AS c FROM users")
        users = int(cur.fetchone()["c"])
        cur.execute("SELECT COUNT(*) AS c FROM attempts")
        attempts = int(cur.fetchone()["c"])
        cur.execute("SELECT COUNT(*) AS c FROM attempts WHERE status='finished'")
        finished = int(cur.fetchone()["c"])
        cur.execute("SELECT COUNT(*) AS c FROM attempts WHERE status='quit'")
        quits = int(cur.fetchone()["c"])
        cur.execute("SELECT AVG(total_ms) AS a FROM attempts WHERE status='finished' AND total_ms IS NOT NULL")
        avg_total = cur.fetchone()["a"]
        cur.execute("SELECT AVG(wrong_count) AS a FROM attempts WHERE status='finished'")
        avg_wrong = cur.fetchone()["a"]

    avg_total_s = fmt_ms(int(avg_total)) if avg_total is not None else "‚Äî"
    avg_wrong_s = f"{float(avg_wrong):.2f}" if avg_wrong is not None else "‚Äî"

    return (
        "–°–≤–æ–¥–∫–∞\n\n"
        f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {users}\n"
        f"–ü–æ–ø—ã—Ç–æ–∫: {attempts}\n"
        f"–ó–∞–≤–µ—Ä—à–∏–ª–∏: {finished}\n"
        f"–°–¥–∞–ª–∏—Å—å: {quits}\n"
        f"–°—Ä–µ–¥–Ω–µ–µ –∏—Ç–æ–≥–æ–≤–æ–µ –≤—Ä–µ–º—è: {avg_total_s}\n"
        f"–°—Ä–µ–¥–Ω–µ–µ –æ—à–∏–±–æ–∫: {avg_wrong_s}\n"
        f"–í–æ–ø—Ä–æ—Å–æ–≤ –∑–∞ —Ç–µ—Å—Ç: {QUESTIONS_PER_RUN}\n"
        f"–®—Ç—Ä–∞—Ñ –∑–∞ –æ—à–∏–±–∫—É: {WRONG_PENALTY_MS/1000:.0f} —Å–µ–∫\n"
    )

def stats_users_text(limit: int = 20) -> str:
    with db_connect() as con, con.cursor() as cur:
        cur.execute("""
            SELECT COALESCE(username, full_name, user_id::text) AS name, last_seen_ts
            FROM users
            ORDER BY last_seen_ts DESC
            LIMIT %s
        """, (limit,))
        rows = cur.fetchall()

    lines = [f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ {limit})"]
    for r in rows:
        last_s = time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(int(r["last_seen_ts"])))
        lines.append(f"- {r['name']} (last: {last_s})")
    return "\n".join(lines)

def stats_attempts_text(limit: int = 20) -> str:
    with db_connect() as con, con.cursor() as cur:
        cur.execute("""
            SELECT a.id,
                   COALESCE(u.username, u.full_name, u.user_id::text) AS name,
                   a.status, a.total_ms, a.wrong_count, a.penalty_ms
            FROM attempts a
            JOIN users u ON u.user_id = a.user_id
            ORDER BY a.id DESC
            LIMIT %s
        """, (limit,))
        rows = cur.fetchall()

    lines = [f"–ü–æ–ø—ã—Ç–∫–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ {limit})"]
    for r in rows:
        total = fmt_ms(int(r["total_ms"])) if r["total_ms"] is not None else "‚Äî"
        lines.append(f"- #{r['id']} {r['name']} ‚Äî {r['status']} ‚Äî {total} ‚Äî wrong:{r['wrong_count']} penalty:{fmt_ms(int(r['penalty_ms']))}")
    return "\n".join(lines)

def stats_hard_text(limit: int = 10) -> str:
    with db_connect() as con, con.cursor() as cur:
        cur.execute("""
            SELECT question_index,
                   SUM(CASE WHEN is_correct=false THEN 1 ELSE 0 END) AS wrongs,
                   COUNT(*) AS total
            FROM answers
            GROUP BY question_index
            ORDER BY wrongs DESC, total DESC
            LIMIT %s
        """, (limit,))
        rows = cur.fetchall()

    if not rows:
        return "–°–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n\n–ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö (–Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –∫—Ç–æ-—Ç–æ –æ—Ç–≤–µ—á–∞–ª)."

    lines = ["–°–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (–ø–æ –æ—à–∏–±–∫–∞–º):"]
    for r in rows:
        qi = int(r["question_index"])
        title = QUESTIONS[qi].text if 0 <= qi < len(QUESTIONS) else f"–í–æ–ø—Ä–æ—Å #{qi}"
        lines.append(f"- {title}\n  –û—à–∏–±–æ–∫: {int(r['wrongs'])} –∏–∑ {int(r['total'])}")
    return "\n".join(lines)

def stats_events_text(limit: int = 25) -> str:
    with db_connect() as con, con.cursor() as cur:
        cur.execute("""
            SELECT e.ts,
                   COALESCE(u.username, u.full_name, u.user_id::text) AS name,
                   e.event_type
            FROM events e
            LEFT JOIN users u ON u.user_id = e.user_id
            ORDER BY e.id DESC
            LIMIT %s
        """, (limit,))
        rows = cur.fetchall()

    lines = [f"–°–æ–±—ã—Ç–∏—è (–ø–æ—Å–ª–µ–¥–Ω–∏–µ {limit})"]
    for r in rows:
        ts_s = time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(int(r["ts"])))
        lines.append(f"- {ts_s} ‚Äî {r['name']} ‚Äî {r['event_type']}")
    return "\n".join(lines)

def export_csv_bytes() -> Tuple[bytes, str]:
    with db_connect() as con, con.cursor() as cur:
        out = io.StringIO()
        w = csv.writer(out)

        out.write("=== USERS ===\n")
        w.writerow(["user_id", "username", "full_name", "first_seen_ts", "last_seen_ts"])
        cur.execute("SELECT user_id, username, full_name, first_seen_ts, last_seen_ts FROM users ORDER BY last_seen_ts DESC")
        for r in cur.fetchall():
            w.writerow([r["user_id"], r["username"], r["full_name"], r["first_seen_ts"], r["last_seen_ts"]])

        out.write("\n=== ATTEMPTS ===\n")
        w.writerow(["id", "user_id", "status", "started_ts", "ended_ts", "wrong_count", "penalty_ms", "elapsed_ms", "total_ms", "questions_per_run", "wrong_penalty_ms"])
        cur.execute("""
            SELECT id, user_id, status, started_ts, ended_ts, wrong_count, penalty_ms, elapsed_ms, total_ms, questions_per_run, wrong_penalty_ms
            FROM attempts
            ORDER BY id DESC
        """)
        for r in cur.fetchall():
            w.writerow([r["id"], r["user_id"], r["status"], r["started_ts"], r["ended_ts"], r["wrong_count"], r["penalty_ms"],
                        r["elapsed_ms"], r["total_ms"], r["questions_per_run"], r["wrong_penalty_ms"]])

        out.write("\n=== ANSWERS ===\n")
        w.writerow(["id", "attempt_id", "user_id", "ts", "pos", "question_index", "option_index", "is_correct", "penalty_ms_after", "total_ms_now"])
        cur.execute("""
            SELECT id, attempt_id, user_id, ts, pos, question_index, option_index, is_correct, penalty_ms_after, total_ms_now
            FROM answers
            ORDER BY id DESC
        """)
        for r in cur.fetchall():
            w.writerow([r["id"], r["attempt_id"], r["user_id"], r["ts"], r["pos"], r["question_index"], r["option_index"],
                        r["is_correct"], r["penalty_ms_after"], r["total_ms_now"]])

    data = out.getvalue().encode("utf-8")
    filename = f"bot_stats_export_{int(time.time())}.csv.txt"
    return data, filename

# ==========================================================
# ====================== UI –ö–ù–û–ü–ö–ò =========================
# ==========================================================
def main_menu_kb() -> InlineKeyboardMarkup:
    return InlineKeyboardMarkup([
        [InlineKeyboardButton("–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç", callback_data="start_quiz")],
        [InlineKeyboardButton("–¢–µ–æ—Ä–∏—è", callback_data="theory:0")],
        [InlineKeyboardButton("–õ–∏–¥–µ—Ä—ã", callback_data="leaderboard")],
        [InlineKeyboardButton("–ö–∞–∫ –∏–≥—Ä–∞—Ç—å", callback_data="help")],
    ])

def theory_kb(page: int, total: int) -> InlineKeyboardMarkup:
    prev_btn = InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"theory:{page-1}") if page > 0 else InlineKeyboardButton(" ", callback_data="noop")
    next_btn = InlineKeyboardButton("‚û°Ô∏è", callback_data=f"theory:{page+1}") if page < total - 1 else InlineKeyboardButton(" ", callback_data="noop")
    return InlineKeyboardMarkup([
        [prev_btn, InlineKeyboardButton("–ú–µ–Ω—é", callback_data="menu"), next_btn],
        [InlineKeyboardButton("–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç", callback_data="start_quiz")],
    ])

def quiz_kb(current_q_index: int, options: List[str]) -> InlineKeyboardMarkup:
    rows = [[InlineKeyboardButton(opt, callback_data=f"ans:{current_q_index}:{i}")] for i, opt in enumerate(options)]
    rows.append([InlineKeyboardButton("–°–¥–∞—Ç—å—Å—è", callback_data="quit"), InlineKeyboardButton("–ú–µ–Ω—é", callback_data="menu")])
    rows.append([InlineKeyboardButton("–õ–∏–¥–µ—Ä—ã", callback_data="leaderboard")])
    return InlineKeyboardMarkup(rows)

def finish_kb() -> InlineKeyboardMarkup:
    return InlineKeyboardMarkup([
        [InlineKeyboardButton("–ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑", callback_data="start_quiz")],
        [InlineKeyboardButton("–õ–∏–¥–µ—Ä—ã", callback_data="leaderboard")],
        [InlineKeyboardButton("–¢–µ–æ—Ä–∏—è", callback_data="theory:0")],
        [InlineKeyboardButton("–ú–µ–Ω—é", callback_data="menu")],
    ])

def stats_menu_kb() -> InlineKeyboardMarkup:
    return InlineKeyboardMarkup([
        [InlineKeyboardButton("–°–≤–æ–¥–∫–∞", callback_data="stats:overview")],
        [InlineKeyboardButton("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏", callback_data="stats:users")],
        [InlineKeyboardButton("–ü–æ–ø—ã—Ç–∫–∏", callback_data="stats:attempts")],
        [InlineKeyboardButton("–°–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã", callback_data="stats:hard")],
        [InlineKeyboardButton("–°–æ–±—ã—Ç–∏—è", callback_data="stats:events")],
        [InlineKeyboardButton("–≠–∫—Å–ø–æ—Ä—Ç CSV", callback_data="stats:export")],
        [InlineKeyboardButton("–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É", callback_data="stats:clear_confirm")],
        [InlineKeyboardButton("–ú–µ–Ω—é", callback_data="menu")],
    ])

def clear_confirm_kb() -> InlineKeyboardMarkup:
    return InlineKeyboardMarkup([
        [InlineKeyboardButton("–î–ê, –æ—á–∏—Å—Ç–∏—Ç—å", callback_data="stats:clear_yes")],
        [InlineKeyboardButton("–û—Ç–º–µ–Ω–∞", callback_data="stats:clear_no")],
    ])

# ==========================================================
# ====================== –≠–ö–†–ê–ù–´ ============================
# ==========================================================
async def show_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    u = update.effective_user
    if u:
        uid, _, _ = upsert_user(u)
        log_event(uid, "menu_open")

    await send(
        update,
        f"–ü—Ä–∏–≤–µ—Ç!\n\n"
        f"–¢–µ—Å—Ç: {QUESTIONS_PER_RUN} –≤–æ–ø—Ä–æ—Å–æ–≤ (—Å–ª—É—á–∞–π–Ω–æ –∏–∑ –æ–±—â–µ–≥–æ —Å–ø–∏—Å–∫–∞)\n"
        f"–®—Ç—Ä–∞—Ñ –∑–∞ –æ—à–∏–±–∫—É: +{int(WRONG_PENALTY_MS/1000)} —Å–µ–∫\n\n"
        f"–í—ã–±–∏—Ä–∞–π –¥–µ–π—Å—Ç–≤–∏–µ:",
        reply_markup=main_menu_kb(),
    )

async def show_help(update: Update, context: ContextTypes.DEFAULT_TYPE):
    u = update.effective_user
    if u:
        uid, _, _ = upsert_user(u)
        log_event(uid, "help_open")

    await send(
        update,
        "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:\n\n"
        "1) –ù–∞–∂–º–∏ ¬´–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç¬ª\n"
        "2) –û—Ç–≤–µ—á–∞–π –∫–Ω–æ–ø–∫–∞–º–∏\n"
        f"3) –ù–µ–≤–µ—Ä–Ω–æ ‚Äî —à—Ç—Ä–∞—Ñ +{int(WRONG_PENALTY_MS/1000)} —Å–µ–∫\n"
        "4) –í–µ—Ä–Ω–æ ‚Äî —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å\n"
        "5) –í –∫–æ–Ω—Ü–µ –±—É–¥–µ—Ç –∏—Ç–æ–≥ –∏ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ\n",
        reply_markup=main_menu_kb(),
    )

async def show_theory(update: Update, context: ContextTypes.DEFAULT_TYPE, page: int):
    u = update.effective_user
    if u:
        uid, _, _ = upsert_user(u)
        log_event(uid, "theory_open", payload_json=f'{{"page":{page}}}')

    pages = chunk_text(THEORY_TEXT)
    page = max(0, min(page, len(pages) - 1))
    await send(
        update,
        f"–¢–µ–æ—Ä–∏—è ({page+1}/{len(pages)})\n\n{pages[page]}",
        reply_markup=theory_kb(page, len(pages)),
    )

async def show_leaderboard(update: Update, context: ContextTypes.DEFAULT_TYPE):
    u = update.effective_user
    if u:
        uid, _, _ = upsert_user(u)
        log_event(uid, "leaderboard_open")

    rows = leaderboard_top(10)
    if not rows:
        await send(update, "–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –ù–∞–∂–º–∏ ¬´–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç¬ª.", reply_markup=main_menu_kb())
        return

    lines = ["–õ–∏–¥–µ—Ä—ã (–ª—É—á—à–µ–µ –∏—Ç–æ–≥–æ–≤–æ–µ –≤—Ä–µ–º—è):"]
    for i, (name, ms) in enumerate(rows, 1):
        lines.append(f"{i}. {name} ‚Äî {fmt_ms(ms)}")
    await send(update, "\n".join(lines), reply_markup=main_menu_kb())

# ==========================================================
# ====================== –¢–ï–°–¢ ==============================
# ==========================================================
async def start_quiz(update: Update, context: ContextTypes.DEFAULT_TYPE):
    u = update.effective_user
    if u:
        uid, _, _ = upsert_user(u)
        log_event(uid, "quiz_start_clicked")

    order = build_quiz_order()
    context.user_data["order"] = order
    context.user_data["pos"] = 0
    context.user_data["t0"] = time.time()
    context.user_data["penalty_ms"] = 0
    context.user_data["wrong_count"] = 0

    attempt_id = None
    if u:
        attempt_id = attempt_start(int(u.id))
        context.user_data["attempt_id"] = attempt_id
        log_event(int(u.id), "attempt_started", payload_json=f'{{"attempt_id":{attempt_id}}}')

    await send(update, "–ü–æ–µ—Ö–∞–ª–∏!", reply_markup=None)
    await show_question(update, context)

async def show_question(update: Update, context: ContextTypes.DEFAULT_TYPE):
    order: List[int] = context.user_data.get("order", [])
    pos = int(context.user_data.get("pos", 0))

    if not order or pos >= len(order):
        await finish_quiz(update, context, status="finished")
        return

    q_index = order[pos]
    q = QUESTIONS[q_index]

    total_now = total_time_ms(context)
    penalty = int(context.user_data.get("penalty_ms", 0))
    caption = (
        f"–í–æ–ø—Ä–æ—Å {pos+1}/{len(order)}\n"
        f"–í—Ä–µ–º—è —Å–µ–π—á–∞—Å: {fmt_ms(total_now)} (—à—Ç—Ä–∞—Ñ: {fmt_ms(penalty)})\n\n"
        f"{q.text}"
    )

    kb = quiz_kb(q_index, q.options)

    if q.photo_path:
        try:
            await send_photo(update, q.photo_path, caption=caption, reply_markup=kb)
            return
        except FileNotFoundError:
            caption += "\n\n(–ö–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞)"

    await send(update, caption, reply_markup=kb)

async def finish_quiz(update: Update, context: ContextTypes.DEFAULT_TYPE, status: str):
    u = update.effective_user
    attempt_id = context.user_data.get("attempt_id")

    wrong = int(context.user_data.get("wrong_count", 0))
    penalty = int(context.user_data.get("penalty_ms", 0))
    elapsed = int((time.time() - float(context.user_data.get("t0", time.time()))) * 1000)
    total = elapsed + penalty

    if u:
        uid, _, _ = upsert_user(u)
        log_event(uid, "attempt_ended", payload_json=f'{{"status":"{status}","wrong":{wrong},"penalty_ms":{penalty},"total_ms":{total}}}')

    if attempt_id is not None:
        attempt_finish(int(attempt_id), status=status, elapsed_ms=elapsed, penalty_ms=penalty, wrong_count=wrong)

    # –æ—á–∏—Å—Ç–∏–º —Å–µ—Å—Å–∏—é
    for k in ["order", "pos", "t0", "penalty_ms", "wrong_count", "attempt_id"]:
        context.user_data.pop(k, None)

    if status == "quit":
        await send(update, "–û–∫, –ø–æ–ø—ã—Ç–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.", reply_markup=main_menu_kb())
        return

    # –§–∏–Ω–∞–ª—å–Ω–∞—è —Ñ—Ä–∞–∑–∞ (–∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª)
    await send(
        update,
        "–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! –¢—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –ø—Ä–æ—Ñ–µ—Å—Å–∏—é ¬´–ò–Ω–∂–µ–Ω–µ—Ä-–¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç¬ª\n\n"
        f"–ò—Ç–æ–≥–æ–≤–æ–µ –≤—Ä–µ–º—è: {fmt_ms(total)}\n"
        f"–û—à–∏–±–æ–∫: {wrong} (—à—Ç—Ä–∞—Ñ: {fmt_ms(penalty)})",
        reply_markup=finish_kb(),
    )

async def quit_quiz(update: Update, context: ContextTypes.DEFAULT_TYPE):
    u = update.effective_user
    if u:
        uid, _, _ = upsert_user(u)
        log_event(uid, "quiz_quit_clicked")
    await finish_quiz(update, context, status="quit")

async def handle_answer(update: Update, context: ContextTypes.DEFAULT_TYPE, q_index: int, opt: int):
    query = update.callback_query
    u = update.effective_user

    order: List[int] = context.user_data.get("order", [])
    pos = int(context.user_data.get("pos", 0))
    attempt_id = context.user_data.get("attempt_id")

    if not order or pos >= len(order):
        await query.message.reply_text("–°–µ—Å—Å–∏—è –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞. –ù–∞–∂–º–∏ ¬´–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç¬ª.")
        return

    current_q_index = order[pos]
    if q_index != current_q_index:
        await query.message.reply_text("–≠—Ç–æ —Å—Ç–∞—Ä—ã–µ –∫–Ω–æ–ø–∫–∏. –ù–∞—á–Ω–∏ —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ.")
        return

    q = QUESTIONS[current_q_index]
    total_before = total_time_ms(context)

    if u:
        uid, _, _ = upsert_user(u)
        log_event(uid, "answer_clicked", payload_json=f'{{"q":{current_q_index},"opt":{opt}}}')

    if opt == q.correct:
        if u and attempt_id is not None:
            penalty_after = int(context.user_data.get("penalty_ms", 0))
            log_answer(int(attempt_id), int(u.id), pos, current_q_index, opt, True, penalty_after, total_before)

        context.user_data["pos"] = pos + 1
        await query.message.reply_text("–í–µ—Ä–Ω–æ!\n" + q.explain_right)
        await show_question(update, context)
        return

    # –Ω–µ–≤–µ—Ä–Ω–æ -> —à—Ç—Ä–∞—Ñ
    context.user_data["penalty_ms"] = int(context.user_data.get("penalty_ms", 0)) + WRONG_PENALTY_MS
    context.user_data["wrong_count"] = int(context.user_data.get("wrong_count", 0)) + 1

    penalty_after = int(context.user_data.get("penalty_ms", 0))
    wrong_count = int(context.user_data.get("wrong_count", 0))

    if attempt_id is not None:
        attempt_update_progress(int(attempt_id), wrong_count, penalty_after)

    total_after = total_time_ms(context)

    if u and attempt_id is not None:
        log_answer(int(attempt_id), int(u.id), pos, current_q_index, opt, False, penalty_after, total_after)

    await query.message.reply_text(
        f"–ù–µ–≤–µ—Ä–Ω–æ! +{int(WRONG_PENALTY_MS/1000)} —Å–µ–∫ —à—Ç—Ä–∞—Ñ.\n"
        f"–ü–æ–¥—Å–∫–∞–∑–∫–∞: {q.hint_wrong}\n"
        "–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑."
    )

# ==========================================================
# ====================== ADMIN COMMANDS ====================
# ==========================================================
async def cmd_myid(update: Update, context: ContextTypes.DEFAULT_TYPE):
    u = update.effective_user
    if not u:
        return
    uid, _, _ = upsert_user(u)
    log_event(uid, "cmd_myid")
    await update.message.reply_text(f"–¢–≤–æ–π user_id: {uid}")

async def cmd_stats(update: Update, context: ContextTypes.DEFAULT_TYPE):
    u = update.effective_user
    if not u:
        return
    uid, _, _ = upsert_user(u)
    log_event(uid, "cmd_stats")

    if not is_admin(update):
        await update.message.reply_text("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞.")
        return

    await update.message.reply_text("–ú–µ–Ω—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω):", reply_markup=stats_menu_kb())

async def handle_stats_action(update: Update, action: str):
    if not is_admin(update):
        await send(update, "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞.")
        return

    if action == "overview":
        await send(update, stats_overview_text(), reply_markup=stats_menu_kb())
    elif action == "users":
        await send(update, stats_users_text(20), reply_markup=stats_menu_kb())
    elif action == "attempts":
        await send(update, stats_attempts_text(20), reply_markup=stats_menu_kb())
    elif action == "hard":
        await send(update, stats_hard_text(10), reply_markup=stats_menu_kb())
    elif action == "events":
        await send(update, stats_events_text(25), reply_markup=stats_menu_kb())
    elif action == "export":
        data, filename = export_csv_bytes()
        bio = io.BytesIO(data)
        bio.name = filename
        if update.callback_query:
            await update.callback_query.message.reply_document(document=InputFile(bio, filename=filename), caption="–≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏")
        else:
            await update.message.reply_document(document=InputFile(bio, filename=filename), caption="–≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏")
    elif action == "clear_confirm":
        await send(
            update,
            "–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–Æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.\n–¢–æ—á–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å?",
            reply_markup=clear_confirm_kb(),
        )
    elif action == "clear_yes":
        db_clear_all()
        await send(update, "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—á–∏—â–µ–Ω–∞.", reply_markup=stats_menu_kb())
    elif action == "clear_no":
        await send(update, "–û–∫, –æ—Ç–º–µ–Ω–µ–Ω–æ.", reply_markup=stats_menu_kb())
    else:
        await send(update, "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞.", reply_markup=stats_menu_kb())

# ==========================================================
# ====================== ROUTER ============================
# ==========================================================
async def on_callback(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()
    data = query.data

    u = update.effective_user
    if u:
        uid, _, _ = upsert_user(u)
        log_event(uid, "callback", payload_json=f'{{"data":"{data}"}}')

    if data == "noop":
        return

    if data == "menu":
        await show_menu(update, context)
        return
    if data == "help":
        await show_help(update, context)
        return
    if data == "leaderboard":
        await show_leaderboard(update, context)
        return
    if data == "start_quiz":
        await start_quiz(update, context)
        return
    if data == "quit":
        await quit_quiz(update, context)
        return
    if data.startswith("theory:"):
        page = int(data.split(":")[1])
        await show_theory(update, context, page)
        return
    if data.startswith("stats:"):
        action = data.split(":")[1]
        await handle_stats_action(update, action)
        return
    if data.startswith("ans:"):
        _, q_index_s, opt_s = data.split(":")
        await handle_answer(update, context, int(q_index_s), int(opt_s))
        return

async def cmd_start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await show_menu(update, context)

async def on_text(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await show_menu(update, context)

async def on_error(update: object, context: ContextTypes.DEFAULT_TYPE):
    # –æ—à–∏–±–∫–∏ –±—É–¥—É—Ç –≤–∏–¥–Ω—ã –≤ Railway logs
    print("ERROR:", repr(context.error))

def ensure_ready():
    print("BOOT: BOT_TOKEN:", bool(BOT_TOKEN))
    print("BOOT: DATABASE_URL:", bool(DATABASE_URL))
    print("BOOT: ADMIN_IDS:", ADMIN_IDS)
    print("BOOT: QUESTIONS:", len(QUESTIONS))
    print("BOOT: QUESTIONS_PER_RUN:", QUESTIONS_PER_RUN)
    if not BOT_TOKEN:
        raise RuntimeError("BOT_TOKEN –Ω–µ –∑–∞–¥–∞–Ω (Railway Variables).")
    if not DATABASE_URL:
        raise RuntimeError("DATABASE_URL –Ω–µ –∑–∞–¥–∞–Ω (Railway Variables).")
    if len(QUESTIONS) < QUESTIONS_PER_RUN:
        raise RuntimeError("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ QUESTIONS.")

def main():
    ensure_ready()
    db_init()
    print("BOOT: db_init OK")

    app = Application.builder().token(BOT_TOKEN).build()
    app.add_error_handler(on_error)

    app.add_handler(CommandHandler("start", cmd_start))
    app.add_handler(CommandHandler("myid", cmd_myid))
    app.add_handler(CommandHandler("stats", cmd_stats))

    app.add_handler(CallbackQueryHandler(on_callback))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, on_text))

    print("BOOT: polling start")
    app.run_polling()

if __name__ == "__main__":
    main()

